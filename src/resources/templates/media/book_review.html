<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="en" xmlns="http://www.w3.org/1999/xhtml">
    <head th:replace="head :: copy"></head>
    <body>

        <div th:replace="header/headerWithFilter :: copy"></div>

        <div class="container bookinfo">
            <div class="card">
                <div class="card-body row">
                    <div class="col"><img th:src="'/img/'+${medium.getPictureUrl()}"  /></div>
                    <div class="col">
                        <p class="brtitle">Title:</p>
                        <p class = "brvalue" th:text="${medium.getTitle()}"></p>
                        <p class="brtitle">Author:</p>
                        <p class = "brvalue" th:text="${medium.getAuthor().getName()}"></p>
                        <p class="brtitle">Year of release:</p>
                        <p class = "brvalue" th:text="${medium.getYear()}"></p>
                        <div class="row">
                            <span class="col">
                                <form th:action="'/rating/'+${medium.getId()}"  method="get">
                                    <input class="btn btn-primary ml-auto" type="submit" value ="Add Rating"/>
                                </form>
                            </span>
                            <span class="col">
                                <form th:action="'/review/'+${medium.getId()}" method="get">
                                    <input class="btn btn-primary ml-auto" type="submit" value ="Add Review"/>
                                </form>
                            </span>
                            <span class="col">
                                <form action="/rent" method="post">
                                    <input type="hidden" th:name="media_id" th:value="${medium.getId()}" />
                                    <div class="d-flex" th:if="${medium.isCopyAvailable()}">
                                        <input class="btn btn-primary ml-auto" type="submit" value ="Rent"/>
                                    </div>
                                    <div class="d-flex" th:unless="${medium.isCopyAvailable()}">
                                        <input class="btn btn-secondary ml-auto" type="submit" value ="Rent" disabled=""/>
                                    </div>
                                </form>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <div class="card">
                    <div class="card-body row" id="brmedia">
                        <span class="brbottom col">
                            <strong><span>Category:</span></strong>
                            <span th:text="'&nbsp;'+${#strings.toLowerCase(medium.getCategory().getType())}+'&nbsp;'"></span>
                        </span>
                        <span class="brbottom col">
                            <strong><span>Genres:</span></strong>
                            <span th:each="genre,iterStat : ${medium.getGenres()}">
                                <span th:text="'&nbsp;'+${#strings.toLowerCase(genre.getType())}+'&nbsp;'"></span>
                            </span>
                        </span>
                        <span class="brbottom col">
                            <strong><span>Rating:</span></strong>
                            <span th:text="${averageRating}"></span>
                        </span>
                        <span class="brbottom col">
                            <span th:if="${medium.isCopyAvailable()}">
                                <span>The book is available</span>
                            </span>
                            <span th:unless="${medium.isCopyAvailable()}">
                                <span th:text="${nextAvailableRentDate}==null ? 'Pending! Please come back later!':'The book will be available at '+${nextAvailableRentDate}"></span>
                            </span>
                        </span>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <strong>Description:</strong>
                </div>
                <div class="card-body">
                    <p th:text="${medium.getDescription()}"></p>
                </div>
            </div>

            <div class="breadcrumb">
                <strong>User reviews: </strong>
            </div>
            <div th:text="${#lists.size(medium.getReviews())} == 0 ? 'Noone gave a review yet be the first!' : '' "></div>
            <div th:each="review,iterStat : ${medium.getReviews()}">
                <div class="card">
                    <div class="card-header">
                        <strong th:text="${review.getMember().getName()}"></strong>
                    </div>
                    <div class="card-body">
                        <p th:text="${review.getReviewText()}"></p>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>